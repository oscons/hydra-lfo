(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.hydralfo = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
(function (global){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.init=void 0;function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray(a)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}function _arrayWithoutHoles(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}}function _typeof(a){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(a,b){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a)){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}}function _arrayWithHoles(a){if(Array.isArray(a))return a}function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(b,!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(b).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}// eslint-disable-next-line no-empty-function
var ud=function(){}(),CANARY="__hydralfo_func",mix_values=function(c,a,b){return 0===b?c:1===b?a:c*(1-b)+a*b},undefault=function(a,b){return"undefined"==typeof a?b:a},expand_args=function(a,b){var c=Math.min,d=_objectSpread({},undefault(a,{}));if("undefined"!=typeof b&&0<b.length){var e=_slicedToArray(b,1),f=e[0];if("object"===_typeof(f)&&!Array.isArray(f))for(var g in a)g in f&&(d[g]=f[g]);else{var h=Object.keys(a);h=h.slice(0,c(h.length,b.length)),h.forEach(function(a,c){d[a]=b[c]})}}return Object.keys(d).forEach(function(b){var c=d[b],e=a[b];d[b]="function"==typeof c?function(a,b,d){var f=d;if("undefined"==typeof f&&(f=[{}]),CANARY in c){// make a 1 level copy of the call args for the call to the sub-chain
var g=[];return f.forEach(function(a){"object"===_typeof(a)?Array.isArray(a)?g.push(_toConsumableArray(a)):"call"in a?g.push(a):g.push(_objectSpread({},a)):g.push(a)}),undefault(c.run(g),e)}return undefault(c(a,b,f),e)}:"undefined"==typeof c?function(){return e}:function(){return c}}),d},get_time=function(a,b){var c=!!(2<arguments.length&&arguments[2]!==void 0)&&arguments[2],d=ud,e=b;if(Array.isArray(e)&&0<e.length){var f=e,g=_slicedToArray(f,1);e=g[0]}if("object"===_typeof(e)&&!Array.isArray(e)){var h=b.time;d=h}return"undefined"==typeof d?"undefined"!=typeof a&&"undefined"!=typeof a.values&&"undefined"!=typeof a.values.time?a.values.time:"undefined"!=typeof window&&"undefined"!=typeof window.time?window.time:c?d:new Date().getTime()/1e3:d},freeze_values=function(a,b,c){return"undefined"==typeof a?a:"function"==typeof a?a.apply(void 0,_toConsumableArray(b).concat([c])):Array.isArray(a)?a.map(function(a){return freeze_values(a,b,c)}):a},_functions={};_functions.add=function(a){var b=expand_args({v:0},a),c=b.v;return function(a,b,d){var e=freeze_values(c,d,b);return undefault(a,0)+e}},_functions.speed=function(a){var b=expand_args({v:ud,m:ud},a),c=b.v,d=b.m;return function(a,b,e){var f=freeze_values([c,d],e,b),g=_slicedToArray(f,2),h=g[0],i=g[1],j=1;return"undefined"==typeof h?"undefined"!=typeof a&&(j=a):"undefined"==typeof a?j=h:"undefined"==typeof i?j=h:j=mix_values(h,a,i),b.values.time=j*b.values.time,a}},_functions.fast=function(a){var b=expand_args({s:ud,o:0,m:0},a),c=b.s,d=b.o,e=b.m;return function(a,b,f){var g=freeze_values([c,d,e],f,b),h=_slicedToArray(g,3),i=h[0],j=h[1],k=h[2],l=1;return"undefined"==typeof a?"undefined"!=typeof i&&(l=i):"undefined"==typeof i?l=a:l=mix_values(i,a,k),b.values.time=l*b.values.time+j,a}},_functions.time=function(a){var b=expand_args({s:1,o:0},a),c=b.s,d=b.o;return function(a,b,e){var f=freeze_values([c,d],e,b),g=_slicedToArray(f,2),h=g[0],i=g[1];return get_time(b,e)*h+i}},_functions.rnd=function(a){var b=expand_args({s:ud,o:0,m:0},a),c=b.s,d=b.o,e=b.m;return function(a,b,f){var g=freeze_values([c,d,e],f,b),h=_slicedToArray(g,3),i=h[0],j=h[1],k=h[2],l=1;return"undefined"==typeof a?"undefined"!=typeof i&&(l=i):"undefined"==typeof i?l=a:l=mix_values(l,a,k),Math.random()*l+j}},_functions.range=function(a){var b=expand_args({u:10,l:0,s:1},a),c=b.u,d=b.l,e=b.s;return function(a,b,f){var g=freeze_values([e,c,d],f,b),h=_slicedToArray(g,3),i=h[0],j=h[1],k=h[2],l=0;if(b.private_state.prev){var m=b.private_state.prev.spi,n=void 0===m?0:m;l=n+i+a,l>=j&&(l=k),l<k&&0>i&&(l=j)}else l=0<i?k:j;return b.private_state.prev={spi:l},l}},_functions.iter=function(a){var b=expand_args({v:[0,1],s:1},a),c=b.v,d=b.s;return function(a,b,e){var f=freeze_values([c,d],e,b),g=_slicedToArray(f,2),h=g[0],i=g[1],j=b.private_state.prev?b.private_state.prev:{},k=j.pi,l=void 0===k?0:k;b.private_state.prev&&(l=i+l+undefault(a,0)),b.private_state.prev={pi:l};var m=h,n=Math.floor(l);n%=m.length;var o=m[n];return"function"==typeof o?o(a,b,e):o}},_functions.choose=function(a){var b=expand_args({v:[0,1],s:1},a),c=b.v,d=b.s;return function(a,b,e){var f=freeze_values([c,d],e,b),g=_slicedToArray(f,2),h=g[0],i=g[1];if(0===h.length)return 0;var j=undefault(a,0);j*=i,j=Math.floor(Math.abs(j)),j%=h.length;for(var k,l=h[j],m="choose_mark_".concat(new Date().getTime()),n=10;"function"==typeof l;){if(k=l,k.__choose_mark=m,l=k.apply(void 0,_toConsumableArray(e).concat([b])),0>=n--||"function"==typeof l&&l.__choose_mark===m){l=0;break}delete k.__choose_mark}return l}},_functions.sin=function(a){var b=expand_args({f:1,s:1,o:0},a),c=b.f,d=b.s,e=b.o;return function(a,b,f){var g=Math.sin,h=Math.PI,i=freeze_values([c,d,e],f,b),j=_slicedToArray(i,3),k=j[0],l=j[1],m=j[2],n=0;return n="undefined"==typeof a?get_time(b,f):a,n=undefault(n,Math.PI),(g(2*n*h*k)/2+.5)*l+m}},_functions.floor=function(a){var b=expand_args({d:0},a),c=b.d;return function(a,b,d){var e=freeze_values(c,d,b),f=Math.pow(10,e);return Math.floor(a*f)/f}},_functions.set=function(a){var b=expand_args({v:0},a),c=b.v;return function(a,b,d){var e=freeze_values(c,d,b);return e}},_functions.mul=function(a){var b=expand_args({v:0},a),c=b.v;return function(a,b,d){var e=freeze_values(c,d,b);return a*e}},_functions.div=function(a){var b=expand_args({v:1},a),c=b.v;return function(a,b,d){var e=freeze_values(c,d,b),f=undefault(a,0);return 0===e?f/1e-13:f/e}},_functions.mod=function(a){var b=expand_args({v:1},a),c=b.v;return function(a,b,d){var e=freeze_values(c,d,b);return 0===e?0:undefault(a,0)%e}},_functions.slew=function(a){var b=expand_args({r:1,x:Number.MAX_VALUE},a),c=b.r,d=b.x;return function(a,b,e){var f=freeze_values([c,d],e,b),g=_slicedToArray(f,2),h=g[0],i=g[1];b.private_state.prev||(b.private_state.prev=a);var j=a;"undefined"==typeof j&&(j=b.private_state.prev);var k=j-b.private_state.prev;0<h&&(k*=1-1/h),0<k?k>i&&(k=i):k<-i&&(k=-i);var l=b.private_state.prev+k;return b.private_state.prev=l,l}},_functions.map=function(a){var b=expand_args({f:function f(a){return a}},a),c=b.f;return function(a,b,d){return c.apply(void 0,[a,b].concat(_toConsumableArray(d)))}},_functions.beats=function(a){var b=expand_args({s:1,b:ud},a),c=b.s,d=b.b;return function(a,b,e){var f=freeze_values([c,d],e,b),g=_slicedToArray(f,2),h=g[0],i=g[1],j=e.time,k=e.bpm,l=i;return"undefined"==typeof l&&(l=k),b.values.time=undefault(j,0)/60*l*h,a}},_functions.use=function(a){var b=expand_args({n:"val",c:!1},a),c=b.n,d=b.c;return function(a,b,e){var f=freeze_values([c,d],e,b),g=_slicedToArray(f,2),h=g[0],i=g[1],j=b.values[h];return i&&(j=a),b.current_value=h,j}},_functions.noop=function(){return function(a){return a}},_functions.gen=_functions.noop,_functions.used=function(){return function(a,b){return b.current_value}};var run_calls=function(a,b,c,d){var e=d;("undefined"==typeof e||0===e.length)&&(e=[{}]),"undefined"==typeof e[0]&&(e[0]={});var f={input:ud,current_value:"val",values:_objectSpread({val:ud,initial_args:d},e[0]),global_state:a,instance_state:b,private_state:{}};f.values.initial_time=get_time(f.values,f.values),f.values.time=f.values.initial_time,e[0]=f.values,c.forEach(function(a){var b=_slicedToArray(a,2),c=b[0],d=b[1];f.private_state=d,f.input=f.values[f.current_value];var g=c(f.input,f,e);f.values[f.current_value]=g});var g=f.values[f.current_value];return"undefined"==typeof g?0:g},sub_call=function(a,b,c){var d=b.map(function(a){return[a,{}]}),e={};"undefined"!=typeof c&&d.push([c,{}]);var f=function(){for(var b=arguments.length,c=Array(b),f=0;f<b;f++)c[f]=arguments[f];return run_calls(a,e,d,c)};return f.run=f,f[CANARY]=!0,Object.entries(_functions).forEach(function(b){var c=_slicedToArray(b,2),e=c[0],g=c[1];if(e in f&&!(e in Object.getOwnPropertyNames()))throw new Error("".concat(e," already exists on parents of rfun"));f[e]=function(){for(var b=arguments.length,c=Array(b),e=0;e<b;e++)c[e]=arguments[e];return sub_call(a,d.map(function(a){var b=_slicedToArray(a,1),c=b[0];return c}),g(c))}}),f},get_global_env=function(){return"undefined"==typeof window?global:window},make_new_lfo=function(a){var b={},c="undefined"==typeof a?{}:a;return Object.keys(_functions).forEach(function(a){b[a]=function(){var b;return(b=sub_call(c,[]))[a].apply(b,arguments)}}),b.__release=function(){// for future use, e.g. to stop timeouts etc
},b},GLOBAL_INIT_ID="__hydralfo_global",init=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:ud,b=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],c=!!(2<arguments.length&&arguments[2]!==void 0)&&arguments[2],d=make_new_lfo(a);if(!b)return d;var e=get_global_env();if("undefined"!=typeof e){if(CANARY in e){var f=e[CANARY];if("object"===_typeof(f)){if(!c)return e[CANARY];"__release"in f&&f.__release(d)}}e[CANARY]=d}return d};exports.init=init;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}]},{},[1])(1)
});
//# sourceMappingURL=hydralfo.min.js.map
